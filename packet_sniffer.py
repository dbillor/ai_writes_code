from scapy.all import *\nimport collections\nimport time\n\ndef packet_callback(packet):\n    if IP in packet:\n        ip_src = packet[IP].src\n        ip_dst = packet[IP].dst\n        ip_counter.update([ip_src, ip_dst])\n\nif __name__ == __main__:\n    ip_counter = collections.Counter()\n    while True:\n        sniff(prn=packet_callback, count=100)\n        top_ips = ip_counter.most_common(10)\n        print(Top10IPs:)\n        for ip, count in top_ips:\n            print(f{ip}:{count})\n        time.sleep(60)
